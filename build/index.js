"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(exports,"__esModule",{value:!0});var _reactAddons=require("react/addons"),_reactAddons2=_interopRequireDefault(_reactAddons),_moment=require("moment"),_moment2=_interopRequireDefault(_moment);exports["default"]=_reactAddons2["default"].createClass({displayName:"IdleTimer",propTypes:{timeout:_reactAddons2["default"].PropTypes.number,events:_reactAddons2["default"].PropTypes.arrayOf(_reactAddons2["default"].PropTypes.string),idleAction:_reactAddons2["default"].PropTypes.func,activeAction:_reactAddons2["default"].PropTypes.func,element:_reactAddons2["default"].PropTypes.oneOfType([_reactAddons2["default"].PropTypes.object,_reactAddons2["default"].PropTypes.string]),format:_reactAddons2["default"].PropTypes.string},getDefaultProps:function(){return{timeout:12e5,events:["mousemove","keydown","wheel","DOMMouseScroll","mouseWheel","mousedown","touchstart","touchmove","MSPointerDown","MSPointerMove"],idleAction:function(){},activeAction:function(){},element:document}},getInitialState:function(){return{idle:!1,oldDate:+new Date,lastActive:+new Date,remaining:null,tId:null,pageX:null,pageY:null}},componentWillMount:function(){var t=this;this.props.events.forEach(function(e){t.props.element.addEventListener(e,t._handleEvent)})},componentWillUnmount:function(){var t=this;this.props.events.forEach(function(e){t.props.element.removeEventListener(e,t._handleEvent)})},render:function(){return _reactAddons2["default"].createElement("div",null,this.props.children?this.props.children:"")},_toggleIdleState:function(){this.state.idle?this.props.idleAction():this.props.activeAction(),this.setState({idle:!this.state.idle})},_handleEvent:function(t){if(!this.state.remaining){if("mousemove"===t.type){if(t.pageX===this.state.pageX&&t.pageY===this.state.pageY)return;if("undefined"==typeof t.pageX&&"undefined"==typeof t.pageY)return;var e=+new Date-this.state.oldDate;if(200>e)return}clearTimeout(this.state.tId),this.state.idle&&this._toggleIdleState(t),this.state.lastActive=+new Date,this.state.pageX=t.pageX,this.state.pageY=t.pageY,this.state.tId=setTimeout(this._toggleIdleState,this.props.timeout)}},reset:function(){clearTimeout(this.state.tId),this.setState({idle:!1,oldDate:+new Date,lastActive:this.state.oldDate,remaining:null,tId:this.state.idle?null:setTimeout(this._toggleIdleState,this.props.timeout)})},pause:function(){null===this.state.remaining&&(clearTimeout(this.state.tId),this.setState({remaining:this.props.timeout-(+new Date-this.state.oldDate)}))},resume:function(){null!==this.state.remaining&&(this.state.idle||this.setState({tId:setTimeout(this._toggleIdleState,this.state.remaining),remaining:null}))},getRemainingTime:function(){if(this.state.idle)return 0;if(null!=this.state.remaining)return this.state.remaining;var t=this.props.timeout-(+new Date-this.state.lastActive);return 0>t&&(t=0),t},getElapsedTime:function(){return+new Date-this.state.oldDate},getLastActiveTime:function(){return this.props.format?_moment2["default"](this.state.lastActive).format(this.props.format):this.state.lastActive},isIdle:function(){return this.state.idle}}),module.exports=exports["default"];